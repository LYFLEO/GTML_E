%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Copyright (c) 2014-2018
% Athor: Yang Shubo
% Date: 2018/12/12
% Version: 1.1
% Describe:
% 	Give temperature 'T(K)[200K~3000K]',
%       fuel air ratio 'FAR(-)',
%       flag 'Oil/Gas'. 
%   Return corresponding 'Cp(J/(kg*K))'.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function Cp = Cp_T( T, FAR, flag )

if nargin == 1
    FAR = 0;
    flag = 'Oil';
elseif nargin == 2
    flag = 'Oil';
end

if T < 200
    T = 200;
elseif T > 3000
    T = 3000;
end

Cp = 0;

if strcmp(flag, 'Gas')
    
    Xm = Fuel_Composition( 1, FAR );
    fX = zeros( 1, 4 );
    kX = [ 28 32 44 18 ];

    if Xm(1) > 1e-5
        fX(1) = 2.475830346e6-2.815239891e4*(T/273.15)^(-1.5)+1.116401165e5*(T/273.15)^(-1.25)-8.147644187e5*(T/273.15)^(-0.75)+2.185120405e6*(T/273.15)^(-0.5)-2.978031305e6*(T/273.15)^(-0.25)-1.308008001e6*(T/273.15)^(0.25)+4.305948510e5*(T/273.15)^(0.5)-8.082302563e4*(T/273.15)^(0.75)+6.622545214e3*(T/273.15);
    end

    if Xm(2) > 1e-5
        fX(2) = 6.408242565e5-1.599937045e3*(T/273.15)^(-1.5)+9.984801256e3*(T/273.15)^(-1.25)-1.280873444e5*(T/273.15)^(-0.75)+4.186599156e5*(T/273.15)^(-0.5)-6.720142804e5*(T/273.15)^(-0.25)-3.799977202e5*(T/273.15)^(0.25)+1.378691801e5*(T/273.15)^(0.5)-2.806954185e4*(T/273.15)^(0.75)+2.459943097e3*(T/273.15);
    end

    if Xm(3) > 1e-5
        fX(3) = 1.103695150e6-1.365096910e4*(T/273.15)^(-1.5)+5.357704944e4*(T/273.15)^(-1.25)-3.816063864e5*(T/273.15)^(-0.75)+1.008950325e6*(T/273.15)^(-0.5)-1.352938737e6*(T/273.15)^(-0.25)-5.701809626e5*(T/273.15)^(0.25)+1.828513133e5*(T/273.15)^(0.5)-3.329618224e4*(T/273.15)^(0.75)+2.635366727e3*(T/273.15);
    end

    if Xm(4) > 1e-5
        fX(4) = -4.747782033e6+4.799919289e4*(T/273.15)^(-1.5)-1.931588954e5*(T/273.15)^(-1.25)+1.460728340e6*(T/273.15)^(-0.75)-4.000075762e6*(T/273.15)^(-0.5)+5.576209858e6*(T/273.15)^(-0.25)+2.570488297e6*(T/273.15)^(0.25)-8.670521019e5*(T/273.15)^(0.5)+1.666429390e5*(T/273.15)^(0.75)-1.396634620e4*(T/273.15);
    end

    for i = 1 : 4
            
        Cp = Cp + fX(i) * Xm(i) / kX(i);
    end
else

    tz = T / 1000;
    Xm = FAR/(1 + FAR); 
    Cp = 0.992313+0.236688*tz-1.852148*tz^2+6.083152*tz^3-8.893933*tz^4+7.097112*tz^5-3.234725*tz^6+0.794571*tz^7-0.081873*tz^8;

    if FAR > 1e-5
        Cp = Cp+Xm*(-0.718874+8.747481*tz-15.863157*tz^2+17.254096*tz^3-10.233795*tz^4+3.081778*tz^5-0.361112*tz^6-0.003919*tz^7);
    end
end

Cp = Cp * 1e3;
end